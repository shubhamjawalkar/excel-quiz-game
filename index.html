<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Excel & VBA Master Assessment</title>

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:linear-gradient(135deg,#1f4037,#99f2c8);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.container{
    background:white;
    width:750px;
    max-width:95%;
    padding:30px;
    border-radius:12px;
    box-shadow:0 15px 40px rgba(0,0,0,0.2);
}

h2,h3{margin-top:0}

input{
    width:100%;
    padding:12px;
    margin:10px 0;
    border-radius:6px;
    border:1px solid #ccc;
}

button{
    padding:12px 20px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    background:#1f4037;
    color:white;
    margin-top:10px;
}

button:hover{opacity:0.9}

.option{
    display:block;
    padding:10px;
    margin:8px 0;
    border-radius:6px;
    border:1px solid #ddd;
    cursor:pointer;
    transition:0.2s;
}

.option:hover{background:#f2f2f2}

.selected{
    background:#1f4037;
    color:white;
    border-color:#1f4037;
}

.progress{
    height:8px;
    background:#eee;
    border-radius:5px;
    margin-bottom:15px;
}

.progress-bar{
    height:8px;
    background:#1f4037;
    width:0%;
    border-radius:5px;
}

.timer{
    font-weight:bold;
    color:#d32f2f;
    margin-bottom:10px;
}

.dashboard{
    text-align:center;
}

.leaderboard{
    max-height:150px;
    overflow:auto;
    margin-top:15px;
    border-top:1px solid #ddd;
    padding-top:10px;
    font-size:14px;
}

.hidden{display:none}
</style>
</head>

<body>

<div class="container">

<div id="startScreen">
    <h2>Excel & VBA Master Assessment</h2>

    <h3>üèÜ Leaderboard</h3>
    <div id="leaderboardList" class="leaderboard"></div>

    <input type="text" id="name" placeholder="Enter Your Name">
    <input type="email" id="email" placeholder="Enter Your Email">
    <button onclick="startTest()">Start Test</button>
</div>

<div id="quizScreen" class="hidden">
    <div class="timer">‚è≥ Time Left: <span id="time">30:00</span></div>

    <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <h3 id="question"></h3>
    <div id="options"></div>
    <button onclick="nextQuestion()">Next</button>
</div>

<div id="dashboard" class="hidden dashboard">
    <h2>Assessment Completed</h2>
    <h3 id="userInfo"></h3>
    <h3 id="finalScore"></h3>
    <h3 id="performance"></h3>
    <button onclick="location.reload()">Restart</button>
</div>

</div>

<script>

let userName="", userEmail="";
let current=0;
let score=0;
let selectedAnswer=null;
let timerInterval;
let timeRemaining=1800; // 30 minutes

const questions = [...Array(50)].map((_,i)=>({
    q:`Sample Advanced Excel/VBA Question ${i+1}`,
    o:["Option A","Option B","Option C","Option D"],
    a:Math.floor(Math.random()*4)
}));

// ===== LEADERBOARD =====
function loadLeaderboard(){
    let data=JSON.parse(localStorage.getItem("leaderboard"))||[];
    let html="";
    data.sort((a,b)=>b.score-a.score);
    data.slice(0,5).forEach((item,i)=>{
        html+=`${i+1}. ${item.name} - ${item.score}/50<br>`;
    });
    document.getElementById("leaderboardList").innerHTML=html||"No attempts yet.";
}

function saveLeaderboard(){
    let data=JSON.parse(localStorage.getItem("leaderboard"))||[];
    data.push({name:userName,score:score});
    localStorage.setItem("leaderboard",JSON.stringify(data));
}

// ===== START TEST =====
function startTest(){
    userName=document.getElementById("name").value;
    userEmail=document.getElementById("email").value;

    if(userName===""||userEmail===""){
        alert("Please enter Name and Email");
        return;
    }

    document.getElementById("startScreen").classList.add("hidden");
    document.getElementById("quizScreen").classList.remove("hidden");

    startTimer();
    loadQuestion();
}

// ===== TIMER =====
function startTimer(){
    timerInterval=setInterval(()=>{
        timeRemaining--;
        let minutes=Math.floor(timeRemaining/60);
        let seconds=timeRemaining%60;
        document.getElementById("time").innerText=
            `${minutes}:${seconds<10?"0"+seconds:seconds}`;

        if(timeRemaining<=0){
            clearInterval(timerInterval);
            showDashboard();
        }
    },1000);
}

// ===== LOAD QUESTION =====
function loadQuestion(){
    selectedAnswer=null;
    let q=questions[current];
    document.getElementById("question").innerText=(current+1)+". "+q.q;

    let optionsHTML="";
    q.o.forEach((opt,index)=>{
        optionsHTML+=`<div class="option" onclick="selectOption(this,${index})">${opt}</div>`;
    });

    document.getElementById("options").innerHTML=optionsHTML;
    document.getElementById("progressBar").style.width=((current)/questions.length)*100+"%";
}

// ===== SELECT OPTION =====
function selectOption(element,index){
    document.querySelectorAll(".option").forEach(opt=>opt.classList.remove("selected"));
    element.classList.add("selected");
    selectedAnswer=index;
}

// ===== NEXT QUESTION =====
function nextQuestion(){
    if(selectedAnswer===null){
        alert("Please select an option.");
        return;
    }

    if(selectedAnswer===questions[current].a){
        score++;
    }

    current++;

    if(current<questions.length){
        loadQuestion();
    }else{
        showDashboard();
    }
}

// ===== DASHBOARD =====
function showDashboard(){
    clearInterval(timerInterval);

    document.getElementById("quizScreen").classList.add("hidden");
    document.getElementById("dashboard").classList.remove("hidden");

    let percentage=Math.round((score/questions.length)*100);

    document.getElementById("userInfo").innerText=userName+" | "+userEmail;
    document.getElementById("finalScore").innerText="Score: "+score+" / 50 ("+percentage+"%)";

    let level="Beginner";
    if(percentage>80) level="Excel Master üî•";
    else if(percentage>60) level="Advanced";
    else if(percentage>40) level="Intermediate";

    document.getElementById("performance").innerText="Performance Level: "+level;

    saveLeaderboard();
}

loadLeaderboard();

</script>

</body>
</html>
